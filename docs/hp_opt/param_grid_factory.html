<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>vader.hp_opt.param_grid_factory API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>vader.hp_opt.param_grid_factory</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import random
import itertools
import pandas as pd
from typing import List, Dict, Tuple, Union, Optional
from vader.hp_opt.common import ParamsDictType, ParamsGridType


class ParamGridFactory:
    &#34;&#34;&#34;Contains methods to create parameter dictionaries and parameter grids.&#34;&#34;&#34;

    def get_randomized_param_grid(self, n_sample: int) -&gt; ParamsGridType:
        &#34;&#34;&#34;
        Selects &lt;n_sample&gt; random items (excluding &#39;k&#39;-s) from the full parameter grid.
        If n_sample is greater than the full grid size, returns the full grid.

        Parameters
        ----------
        n_sample : int
            Defines how many sets of hyperparameters (excluding &#39;k&#39;-s) we select from the full grid.

        Returns
        -------
        Parameter grid (list of dictionaries mapping hyperparameters to certain values)
        &#34;&#34;&#34;
        param_dict = self.get_full_param_dict()
        k_list = param_dict[&#34;k&#34;]
        non_k_params_values = [val for key, val in param_dict.items() if key != &#34;k&#34;]
        all_non_k_params_combinations = list(itertools.product(*non_k_params_values))
        if n_sample &gt;= len(all_non_k_params_combinations):
            return self.get_full_param_grid()
        randomized_non_k_params_combinations = random.sample(all_non_k_params_combinations, n_sample)
        randomized_params_combinations = [
            (c[0], *c[1]) for c in itertools.product(k_list, randomized_non_k_params_combinations)
        ]
        randomized_param_grid = pd.DataFrame(
            randomized_params_combinations, columns=param_dict.keys()
        ).to_dict(&#39;records&#39;)
        return randomized_param_grid

    def get_full_param_grid(self) -&gt; ParamsGridType:
        &#34;&#34;&#34;
        Returns the whole parameter grid.

        Returns
        -------
        Parameter grid (list of dictionaries mapping hyperparameters to certain values)
        &#34;&#34;&#34;
        return ParamGridFactory.map_param_dict_to_param_grid(self.get_full_param_dict())

    def get_full_param_dict(self) -&gt; ParamsDictType:
        &#34;&#34;&#34;
        Returns the whole parameter dictionary. This method is supposed to be overridden in sub-classes.
        The current implementation returns the parameter dictionary corresponding to the main paper:
            https://academic.oup.com/gigascience/article/8/11/giz134/5626377

        Returns
        -------
        Parameter dictionary (mapping hyperparameters to their ranges of values)
        &#34;&#34;&#34;
        param_dict = {
            &#34;k&#34;: list(range(2, 11)),
            &#34;n_hidden&#34;: self.gen_list_of_combinations([0, 1, 2, 3, 4, 5, 6]),
            &#34;learning_rate&#34;: [0.0001, 0.001, 0.01, 0.1],
            &#34;batch_size&#34;: [16, 32, 64, 128],
            &#34;alpha&#34;: [1.0]
        }
        return param_dict

    @staticmethod
    def map_param_dict_to_param_grid(param_dict: ParamsDictType) -&gt; ParamsGridType:
        &#34;&#34;&#34;
        Converts a parameters dictionary to a parameters grid.
        The difference is that the parameters grid is a list of dictionaries mapping each of the hyperparameters to
          some certain values, while the parameters dictionary maps each of the hyperparameters to their possible
          ranges of values.
        Parameters dictionary is easier to change for a human, and a parameters grid is easier to handle in the
          hyperparameters optimization process.

        Parameters
        ----------
        param_dict : dictionary[hyperparameter, range of values]

        Returns
        -------
        Parameter grid (list of dictionaries mapping hyperparameters to certain values)
        &#34;&#34;&#34;
        all_params_combinations = list(itertools.product(*param_dict.values()))
        param_grid = pd.DataFrame(all_params_combinations, columns=param_dict.keys()).to_dict(&#39;records&#39;)
        return param_grid

    @staticmethod
    def gen_list_of_combinations(powers: List[int]) -&gt; List[List[int]]:
        &#34;&#34;&#34;
        Auxiliary method to support extensive lists of combinations for n_hidden hyperparameter
          (including all numbers of layers) as powers of &#39;2&#39;.
        Example:
          Input: 0, 1, 2, ..., 6
          Output: (1), (2), (4), ..., (64), (1, 1), (1, 2), ..., (1, 64), ..., (64, 64)

        Parameters
        ----------
        powers : list
            list of integers representing powers of &#39;2&#39;
        Returns
        -------
        List where each elements represents a certain configuration of hidden layers.
        &#34;&#34;&#34;
        powers_of_2 = [2 ** p for p in powers]
        list_of_n_hidden_combinations = [[p] for p in powers_of_2]

        for p in itertools.product(powers_of_2, powers_of_2):
            list_of_n_hidden_combinations.append(list(p))
        return list_of_n_hidden_combinations</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="vader.hp_opt.param_grid_factory.ParamGridFactory"><code class="flex name class">
<span>class <span class="ident">ParamGridFactory</span></span>
</code></dt>
<dd>
<div class="desc"><p>Contains methods to create parameter dictionaries and parameter grids.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ParamGridFactory:
    &#34;&#34;&#34;Contains methods to create parameter dictionaries and parameter grids.&#34;&#34;&#34;

    def get_randomized_param_grid(self, n_sample: int) -&gt; ParamsGridType:
        &#34;&#34;&#34;
        Selects &lt;n_sample&gt; random items (excluding &#39;k&#39;-s) from the full parameter grid.
        If n_sample is greater than the full grid size, returns the full grid.

        Parameters
        ----------
        n_sample : int
            Defines how many sets of hyperparameters (excluding &#39;k&#39;-s) we select from the full grid.

        Returns
        -------
        Parameter grid (list of dictionaries mapping hyperparameters to certain values)
        &#34;&#34;&#34;
        param_dict = self.get_full_param_dict()
        k_list = param_dict[&#34;k&#34;]
        non_k_params_values = [val for key, val in param_dict.items() if key != &#34;k&#34;]
        all_non_k_params_combinations = list(itertools.product(*non_k_params_values))
        if n_sample &gt;= len(all_non_k_params_combinations):
            return self.get_full_param_grid()
        randomized_non_k_params_combinations = random.sample(all_non_k_params_combinations, n_sample)
        randomized_params_combinations = [
            (c[0], *c[1]) for c in itertools.product(k_list, randomized_non_k_params_combinations)
        ]
        randomized_param_grid = pd.DataFrame(
            randomized_params_combinations, columns=param_dict.keys()
        ).to_dict(&#39;records&#39;)
        return randomized_param_grid

    def get_full_param_grid(self) -&gt; ParamsGridType:
        &#34;&#34;&#34;
        Returns the whole parameter grid.

        Returns
        -------
        Parameter grid (list of dictionaries mapping hyperparameters to certain values)
        &#34;&#34;&#34;
        return ParamGridFactory.map_param_dict_to_param_grid(self.get_full_param_dict())

    def get_full_param_dict(self) -&gt; ParamsDictType:
        &#34;&#34;&#34;
        Returns the whole parameter dictionary. This method is supposed to be overridden in sub-classes.
        The current implementation returns the parameter dictionary corresponding to the main paper:
            https://academic.oup.com/gigascience/article/8/11/giz134/5626377

        Returns
        -------
        Parameter dictionary (mapping hyperparameters to their ranges of values)
        &#34;&#34;&#34;
        param_dict = {
            &#34;k&#34;: list(range(2, 11)),
            &#34;n_hidden&#34;: self.gen_list_of_combinations([0, 1, 2, 3, 4, 5, 6]),
            &#34;learning_rate&#34;: [0.0001, 0.001, 0.01, 0.1],
            &#34;batch_size&#34;: [16, 32, 64, 128],
            &#34;alpha&#34;: [1.0]
        }
        return param_dict

    @staticmethod
    def map_param_dict_to_param_grid(param_dict: ParamsDictType) -&gt; ParamsGridType:
        &#34;&#34;&#34;
        Converts a parameters dictionary to a parameters grid.
        The difference is that the parameters grid is a list of dictionaries mapping each of the hyperparameters to
          some certain values, while the parameters dictionary maps each of the hyperparameters to their possible
          ranges of values.
        Parameters dictionary is easier to change for a human, and a parameters grid is easier to handle in the
          hyperparameters optimization process.

        Parameters
        ----------
        param_dict : dictionary[hyperparameter, range of values]

        Returns
        -------
        Parameter grid (list of dictionaries mapping hyperparameters to certain values)
        &#34;&#34;&#34;
        all_params_combinations = list(itertools.product(*param_dict.values()))
        param_grid = pd.DataFrame(all_params_combinations, columns=param_dict.keys()).to_dict(&#39;records&#39;)
        return param_grid

    @staticmethod
    def gen_list_of_combinations(powers: List[int]) -&gt; List[List[int]]:
        &#34;&#34;&#34;
        Auxiliary method to support extensive lists of combinations for n_hidden hyperparameter
          (including all numbers of layers) as powers of &#39;2&#39;.
        Example:
          Input: 0, 1, 2, ..., 6
          Output: (1), (2), (4), ..., (64), (1, 1), (1, 2), ..., (1, 64), ..., (64, 64)

        Parameters
        ----------
        powers : list
            list of integers representing powers of &#39;2&#39;
        Returns
        -------
        List where each elements represents a certain configuration of hidden layers.
        &#34;&#34;&#34;
        powers_of_2 = [2 ** p for p in powers]
        list_of_n_hidden_combinations = [[p] for p in powers_of_2]

        for p in itertools.product(powers_of_2, powers_of_2):
            list_of_n_hidden_combinations.append(list(p))
        return list_of_n_hidden_combinations</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="vader.hp_opt.param_grid_factory.ParamGridFactory.gen_list_of_combinations"><code class="name flex">
<span>def <span class="ident">gen_list_of_combinations</span></span>(<span>powers: List[int]) ‑> List[List[int]]</span>
</code></dt>
<dd>
<div class="desc"><p>Auxiliary method to support extensive lists of combinations for n_hidden hyperparameter
(including all numbers of layers) as powers of '2'.</p>
<h2 id="example">Example</h2>
<p>Input: 0, 1, 2, &hellip;, 6
Output: (1), (2), (4), &hellip;, (64), (1, 1), (1, 2), &hellip;, (1, 64), &hellip;, (64, 64)</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>powers</code></strong> :&ensp;<code>list</code></dt>
<dd>list of integers representing powers of '2'</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>List where each elements represents a certain configuration of hidden layers.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def gen_list_of_combinations(powers: List[int]) -&gt; List[List[int]]:
    &#34;&#34;&#34;
    Auxiliary method to support extensive lists of combinations for n_hidden hyperparameter
      (including all numbers of layers) as powers of &#39;2&#39;.
    Example:
      Input: 0, 1, 2, ..., 6
      Output: (1), (2), (4), ..., (64), (1, 1), (1, 2), ..., (1, 64), ..., (64, 64)

    Parameters
    ----------
    powers : list
        list of integers representing powers of &#39;2&#39;
    Returns
    -------
    List where each elements represents a certain configuration of hidden layers.
    &#34;&#34;&#34;
    powers_of_2 = [2 ** p for p in powers]
    list_of_n_hidden_combinations = [[p] for p in powers_of_2]

    for p in itertools.product(powers_of_2, powers_of_2):
        list_of_n_hidden_combinations.append(list(p))
    return list_of_n_hidden_combinations</code></pre>
</details>
</dd>
<dt id="vader.hp_opt.param_grid_factory.ParamGridFactory.map_param_dict_to_param_grid"><code class="name flex">
<span>def <span class="ident">map_param_dict_to_param_grid</span></span>(<span>param_dict: Dict[str, Union[int, float, List[Union[int, float]]]]) ‑> List[Dict[str, Union[int, float, List[Union[int, float]]]]]</span>
</code></dt>
<dd>
<div class="desc"><p>Converts a parameters dictionary to a parameters grid.
The difference is that the parameters grid is a list of dictionaries mapping each of the hyperparameters to
some certain values, while the parameters dictionary maps each of the hyperparameters to their possible
ranges of values.
Parameters dictionary is easier to change for a human, and a parameters grid is easier to handle in the
hyperparameters optimization process.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>param_dict</code></strong> :&ensp;<code>dictionary[hyperparameter, range</code> of <code>values]</code></dt>
<dd>&nbsp;</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Parameter grid (list</code> of <code>dictionaries mapping hyperparameters to certain values)</code></dt>
<dd>&nbsp;</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def map_param_dict_to_param_grid(param_dict: ParamsDictType) -&gt; ParamsGridType:
    &#34;&#34;&#34;
    Converts a parameters dictionary to a parameters grid.
    The difference is that the parameters grid is a list of dictionaries mapping each of the hyperparameters to
      some certain values, while the parameters dictionary maps each of the hyperparameters to their possible
      ranges of values.
    Parameters dictionary is easier to change for a human, and a parameters grid is easier to handle in the
      hyperparameters optimization process.

    Parameters
    ----------
    param_dict : dictionary[hyperparameter, range of values]

    Returns
    -------
    Parameter grid (list of dictionaries mapping hyperparameters to certain values)
    &#34;&#34;&#34;
    all_params_combinations = list(itertools.product(*param_dict.values()))
    param_grid = pd.DataFrame(all_params_combinations, columns=param_dict.keys()).to_dict(&#39;records&#39;)
    return param_grid</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="vader.hp_opt.param_grid_factory.ParamGridFactory.get_full_param_dict"><code class="name flex">
<span>def <span class="ident">get_full_param_dict</span></span>(<span>self) ‑> Dict[str, Union[int, float, List[Union[int, float]]]]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the whole parameter dictionary. This method is supposed to be overridden in sub-classes.
The current implementation returns the parameter dictionary corresponding to the main paper:
<a href="https://academic.oup.com/gigascience/article/8/11/giz134/5626377">https://academic.oup.com/gigascience/article/8/11/giz134/5626377</a></p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Parameter dictionary (mapping hyperparameters to their ranges</code> of <code>values)</code></dt>
<dd>&nbsp;</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_full_param_dict(self) -&gt; ParamsDictType:
    &#34;&#34;&#34;
    Returns the whole parameter dictionary. This method is supposed to be overridden in sub-classes.
    The current implementation returns the parameter dictionary corresponding to the main paper:
        https://academic.oup.com/gigascience/article/8/11/giz134/5626377

    Returns
    -------
    Parameter dictionary (mapping hyperparameters to their ranges of values)
    &#34;&#34;&#34;
    param_dict = {
        &#34;k&#34;: list(range(2, 11)),
        &#34;n_hidden&#34;: self.gen_list_of_combinations([0, 1, 2, 3, 4, 5, 6]),
        &#34;learning_rate&#34;: [0.0001, 0.001, 0.01, 0.1],
        &#34;batch_size&#34;: [16, 32, 64, 128],
        &#34;alpha&#34;: [1.0]
    }
    return param_dict</code></pre>
</details>
</dd>
<dt id="vader.hp_opt.param_grid_factory.ParamGridFactory.get_full_param_grid"><code class="name flex">
<span>def <span class="ident">get_full_param_grid</span></span>(<span>self) ‑> List[Dict[str, Union[int, float, List[Union[int, float]]]]]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the whole parameter grid.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Parameter grid (list</code> of <code>dictionaries mapping hyperparameters to certain values)</code></dt>
<dd>&nbsp;</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_full_param_grid(self) -&gt; ParamsGridType:
    &#34;&#34;&#34;
    Returns the whole parameter grid.

    Returns
    -------
    Parameter grid (list of dictionaries mapping hyperparameters to certain values)
    &#34;&#34;&#34;
    return ParamGridFactory.map_param_dict_to_param_grid(self.get_full_param_dict())</code></pre>
</details>
</dd>
<dt id="vader.hp_opt.param_grid_factory.ParamGridFactory.get_randomized_param_grid"><code class="name flex">
<span>def <span class="ident">get_randomized_param_grid</span></span>(<span>self, n_sample: int) ‑> List[Dict[str, Union[int, float, List[Union[int, float]]]]]</span>
</code></dt>
<dd>
<div class="desc"><p>Selects <n_sample> random items (excluding 'k'-s) from the full parameter grid.
If n_sample is greater than the full grid size, returns the full grid.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>n_sample</code></strong> :&ensp;<code>int</code></dt>
<dd>Defines how many sets of hyperparameters (excluding 'k'-s) we select from the full grid.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Parameter grid (list</code> of <code>dictionaries mapping hyperparameters to certain values)</code></dt>
<dd>&nbsp;</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_randomized_param_grid(self, n_sample: int) -&gt; ParamsGridType:
    &#34;&#34;&#34;
    Selects &lt;n_sample&gt; random items (excluding &#39;k&#39;-s) from the full parameter grid.
    If n_sample is greater than the full grid size, returns the full grid.

    Parameters
    ----------
    n_sample : int
        Defines how many sets of hyperparameters (excluding &#39;k&#39;-s) we select from the full grid.

    Returns
    -------
    Parameter grid (list of dictionaries mapping hyperparameters to certain values)
    &#34;&#34;&#34;
    param_dict = self.get_full_param_dict()
    k_list = param_dict[&#34;k&#34;]
    non_k_params_values = [val for key, val in param_dict.items() if key != &#34;k&#34;]
    all_non_k_params_combinations = list(itertools.product(*non_k_params_values))
    if n_sample &gt;= len(all_non_k_params_combinations):
        return self.get_full_param_grid()
    randomized_non_k_params_combinations = random.sample(all_non_k_params_combinations, n_sample)
    randomized_params_combinations = [
        (c[0], *c[1]) for c in itertools.product(k_list, randomized_non_k_params_combinations)
    ]
    randomized_param_grid = pd.DataFrame(
        randomized_params_combinations, columns=param_dict.keys()
    ).to_dict(&#39;records&#39;)
    return randomized_param_grid</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="vader.hp_opt" href="index.html">vader.hp_opt</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="vader.hp_opt.param_grid_factory.ParamGridFactory" href="#vader.hp_opt.param_grid_factory.ParamGridFactory">ParamGridFactory</a></code></h4>
<ul class="">
<li><code><a title="vader.hp_opt.param_grid_factory.ParamGridFactory.gen_list_of_combinations" href="#vader.hp_opt.param_grid_factory.ParamGridFactory.gen_list_of_combinations">gen_list_of_combinations</a></code></li>
<li><code><a title="vader.hp_opt.param_grid_factory.ParamGridFactory.get_full_param_dict" href="#vader.hp_opt.param_grid_factory.ParamGridFactory.get_full_param_dict">get_full_param_dict</a></code></li>
<li><code><a title="vader.hp_opt.param_grid_factory.ParamGridFactory.get_full_param_grid" href="#vader.hp_opt.param_grid_factory.ParamGridFactory.get_full_param_grid">get_full_param_grid</a></code></li>
<li><code><a title="vader.hp_opt.param_grid_factory.ParamGridFactory.get_randomized_param_grid" href="#vader.hp_opt.param_grid_factory.ParamGridFactory.get_randomized_param_grid">get_randomized_param_grid</a></code></li>
<li><code><a title="vader.hp_opt.param_grid_factory.ParamGridFactory.map_param_dict_to_param_grid" href="#vader.hp_opt.param_grid_factory.ParamGridFactory.map_param_dict_to_param_grid">map_param_dict_to_param_grid</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>